\chapter{Physics-Based Modeling and Simulation}
\label{chap:4}
%

Numerical approximation methods may utilize an explicit geometric description of the biological tissues to model a wide array of physical phenomena. For these purposes, the discussion will be restricted to modeling quasistatic finite-deformation nonlinear solid mechanics behavior via finite element methods. Selected relevant topics in nonlinear solid mechanics and conventional finite element methods are presented. Concepts are drawn heavily from Rashid~\cite{rashid_2017, rashid_289, rashid_212, rashid_201}, Sukumar~\cite{suku_212}, and Dafalias~\cite{dafalias_205}. Lastly, a brief summary is given of a polyhedral finite element method that is to be explored as an alternative approach in biomechanical modeling.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Nonlinear Solid Mechanics}
\label{Nonlinear Solid Mechanics}

Pertinent topics of nonlinear solid mechanics will be briefly summarized herein. Biological tissues can easily experience strains of 30$\%$ or more, so finite deformation kinematics of material bodies is essential. Although dynamics are of critical importance for many biomechanical studies, the formulation will be restricted here to problems in which inertial terms are considered negligible. This assumption will suffice for the cardiac mechanics applications to be discussed in \chapref{5}, since the motion of the heart is typically taken to be quasistatic.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Kinematical Preliminaries}

The specification of \textit{nonlinear} solid mechanics is due to \textit{geometric nonlinearities} and/or \textit{material nonlinearities}. Contact considerations may also produce nonlinearities, but they will not be considered here. Geometric nonlinearities arise due to the assumed \textit{finite} deformations that occur for a body of interest $\mathcal{B}$. Unlike small deformation solid mechanics, in the case of finite deformations the fixed \textit{reference configuration} $\kappa_0$ and \textit{current configuration} $\kappa_t$ are considered distinct. The reference configuration is typically chosen as the unloaded state of the body, defined at time $t=0$. Material points in the reference configuration are defined by the position vector $\bm{X}$, and locations in the current configuration by $\bm{x}(\bm{X},t)$. The displacement $\bm{u}(\bm{X},t)$ at a material point is $\bm{u}(\bm{X},t) = \bm{x}(\bm{X},t) - \bm{X}$.

The fundamental kinematic quantity in nonlinear solid mechanics is the \textit{deformation gradient} $\bm{F} = \frac{\partial \bm{x}}{\partial \bm{X}}$, which maps infinitesimal line segments in the reference configuration $\bm{dX}$ to infinitesimal line segments in the current configuration $\bm{dx}$, namely: $\bm{dx} = \bm{F}\bm{dX}$. Given the reference configuration and deformation gradient, the current configuration of the deformed body is fully defined. The local volume change at a particular point in $\mathcal{B}$ is defined by the determinant of $\bm{F}$, known as the \textit{Jacobian}: $J = \det{\bm{F}}$.

The mapping from reference configuration to current configuration $\bm{F}$ may be decomposed into a  stretch followed by a pure rotation, or vice versa, in what is known as a \textit{polar decomposition}:
\begin{equation}
\bm{F} = \bm{R}\bm{U} = \bm{V}\bm{R},
\end{equation}
where $\bm{U}$ and $\bm{V}$ are symmetric positive definite tensors, and $\bm{R}$ is a proper orthogonal tensor. Several strain measures may be defined in terms of the deformation gradient. Refer to Chadwick~\cite{chadwick_1999} for a discussion of those definitions.

Although we will focus on quasistatic problems, numerical solutions are still obtained incrementally, and thus rate quantities derived from $\bm{F}$ also come in use. The \textit{rate of deformation} (or stretch rate) tensor $\bm{D}$ and \textit{vorticity} tensor $\bm{W}$ are defined as the symmetric and antisymmetric parts of the spatial \textit{velocity gradient} $\bm{L} = \frac{\partial \bm{v}}{\partial \bm{x}} = \dot{\bm{F}}{\bm{F}}^{-1}$. Thus, $\bm{D} = \frac{1}{2}(\bm{L} + \bm{L}^T)$, $\bm{W} = \frac{1}{2}(\bm{L} - \bm{L}^T)$, and $\bm{L} = \bm{D} + \bm{W}$.

These kinematic quantities will be heavily utilized in developing the governing equations of nonlinear solid mechanics, developing kinematic update strategies to update the solution from one time step to the next, and defining material models and boundary conditions. A more detailed account of continuum kinematics can be found in Dafalias~\cite{dafalias_205} and Chadwick~\cite{chadwick_1999}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Traction and Stress Measures}

We define the \textit{Cauchy traction} $\bm{t}$ at a particular location on a surface in the following manner:
\begin{equation}
\bm{t} = \lim_{\substack{{da} \rightarrow 0, \\ {\bm{n} \text{\ fixed}}}} \frac{{\bm{df}}}{da},
\end{equation}
where $\bm{da} = \bm{n}da$ is an infinitesimal unit of area in the current configuration, and $\bm{n}$ is the corresponding normal to that current-configuration surface. The term $\bm{df}$ is an infinitesimal contact force in the current configuration acting on $\bm{da}$. Thus, the Cauchy traction is defined as the \textit{current configuration force} per \textit{current configuration area} at a given point, acting on a given surface. Applying a balance of linear momentum on an infinitesimal tetrahedral body yields the following relationship: $\bm{t} = \bm{T}^T\bm{n}$. The quantity $\bm{T}$ is the \textit{Cauchy stress} tensor, which defines the current configuration force per current configuration area at a particular location in space \textit{for any surface orientation}. It is the most common measure of stress. The Cauchy stress tensor is symmetric due to conservation of angular momentum for arbitrary portions of a body of interest, and so the more commonly used relationship between Cauchy traction and Cauchy stress is $\bm{t} = \bm{T}\bm{n}$.

Other common measures of stress are the \textit{first Piola-Kirchhoff stress} $\bm{P}$ and \textit{second Piola-Kirchhoff stress} $\bm{S}$. The first P-K stress relates forces in the \textit{current configuration} to areas in the \textit{reference configuration} and is not symmetric. The second P-K stress relates forces that have been \textit{pulled back} to the reference configuration via pre-multiplication by $\bm{F}^{-1}$ to areas in the \textit{reference configuration}.

If we define the surface normal in the reference configuration as $\bm{N}$, we may define the \textit{Piola traction} as $\bm{p} = \bm{P}\bm{N}$ in an analogous manner as was done for Cauchy stress. Cauchy and Piola tractions act in the same direction since they are both defined in terms of current configuration forces. They are related based on static equivalency of forces: $\bm{p}dA = \bm{t}da$, and thus $\bm{p} = \alpha\bm{t}$, where $\alpha = \frac{da}{dA} = J\left(\bm{N} \bm{\cdot} \bm{F}^{-1}\bm{F}^{-T}\bm{N}\right)^{1/2}$ is the \textit{area stretch}.

The Cauchy stress, first P-K stress, and second P-K stress are related to one another in the following manner:
\begin{equation}
\bm{P} = J\bm{T}\bm{F}^{-T} = \bm{F}\bm{S}.
\end{equation}
These relationships arise from utilizing the area ratio and deformation gradient to transform the differential force and differential area between reference and current configurations as needed based on the desired stress measure.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Governing Equations}
Balance of linear momentum for the body $\mathcal{B}$ in the \textit{reference configuration} amounts to the following relationship:
\begin{equation}
\int_{\partial \kappa_0}{p_i}dA + \int_{\kappa_0}\rho_0{b}_idV = 0,
\end{equation}
where $\partial \kappa_0$ is the boundary of the body $\mathcal{B}$ in the reference configuration, $\rho_0$ is the mass per unit reference configuration volume, $\bm{b}(\bm{X})$ is a body force (typically gravity), and inertial terms are deemed negligible. By making use of the relationship $\bm{p} = \bm{P}\bm{N}$ and the divergence and localization theorems, the final governing equations for nonlinear solid mechanics in index notation are:
\begin{gather}
P_{ij,j} + \rho_0b_i = 0, \text{\ \ } \forall \text{\ \ } \bm{X} \in \kappa_0, \label{eqn:equilibrium} \\
{u_i} = \overline{{u}}_i \text{\ \ on\ \ } \partial_u\kappa_0, \\
{p_i} = \overline{{p}}_i\text{\ \ on\ \ } \partial_t\kappa_0,
\end{gather}
where $(),_j = \frac{\partial()}{\partial {{X_j}}}$ are derivatives with respect to the reference-configuration position, $\overline{{u}}_i$ are prescribed displacement boundary conditions, ${\overline{p}_i}$ are prescribed Piola tractions, $\partial_u\kappa_0 \text{\ }\bigcup\text{\ } \partial_t\kappa_0 = \partial\kappa_0$, and $\partial_u\kappa_0 \text{\ }\bigcap\text{\ } \partial_t\kappa_0 = \emptyset$. Robin boundary conditions are omitted here for clarity. Balance of linear momentum is enforced in the \textit{reference} configuration for reasons to be explained in the next section. When the field equations above for nonlinear solid mechanics are combined with the definition of the deformation gradient and with a material model, they form a well-posed elliptic boundary value problem. They constitute what is known as the \textit{strong form} of the problem statement.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The Finite Element Method in Computational Solid Mechanics}
\label{The Finite Element Method in Computational Solid Mechanics}

Finite element methods are the most popular numerical methods for approximating solutions to nonlinear solid mechanics problems. Finite element approximations are based on the \textit{weak}, or \textit{variational} problem statement. The weak form of the problem statement is presented, followed by a brief discussion of Galerkin approximations to the weak form of equilibrium, of which finite element methods are a special case~\cite{rashid_2017}. Some of the major considerations for conventional FEM are discussed, including solution of the nonlinear residual equations, mesh considerations, constitutive models, and boundary conditions.

\subsection{Weak Form and Galerkin Approximation}

The weak form of \eqnref{equilibrium} enforces equilibrium in an average integral sense, in which the equations are dotted with a \textit{test function} $\bm{w}$ and integrated over the domain of $\mathcal{B}$ in the reference configuration:
\begin{equation}
\int_{\kappa_0}{P_{ij,j}}w_idV + \int_{\kappa_0}\rho_0b_iw_idV = 0, \text{\ \ } \forall \text{\ \ } \bm{w} \in \mathcal{V},
\end{equation}
where $\mathcal{V} = \lbrace\bm{w} \text{\ }|\text{\ } \bm{w} \in H^1(\kappa_0), \text{\ }\bm{w} = 0 \text{\ \ on\ } \partial_u\kappa_0\rbrace$.

Define a \textit{trial solution space} $\mathcal{S} = \lbrace\bm{u} \text{\ }|\text{\ } \bm{u} \in H^1(\kappa_0), \text{\ }\bm{u} = \overline{\bm{u}} \text{\ \ on\ } \partial_u\kappa_0\rbrace$  to which displacements $\bm{u}$ must belong. Utilizing the divergence theorem, the weak form of equilibrium takes the following form:

Find $\bm{u}(\bm{X},t) \in \mathcal{S}$ such that
\begin{gather}
\int_{\kappa_0}P_{ij}w_{i,j}dV - \int_{\kappa_0}\rho_0b_iw_idV - \int_{\partial_t\kappa_0}\overline{p}_iw_idA = 0 \text{\ \ } \forall \text{\ \ } \bm{w} \in \mathcal{V}.
\end{gather}

The weak form is solved by \textit{Galerkin approximation}, which involves approximating $\bm{u}$ and $\bm{w}$ with linear combinations of a finite set of \textit{basis functions} $\phi_a$:
\begin{gather}
\bm{u}(\bm{X},t) = \sum\limits_{a}\bm{u}_a(t)\phi_a(\bm{X}), \\
\bm{w}(\bm{X}) = \sum\limits_{a}\bm{w}_a\phi_a(\bm{X}),
\end{gather}
where $\bm{u}_a$ and $\bm{w}_a$ are nodal values. The approximation is of the Galerkin variety because the basis functions used to approximate $\bm{u}$ and $\bm{w}$ are chosen to be identical. A finite discretization of the geometry of the reference configuration $\kappa_0$ provides the nodes and elements that approximate the geometry of the body, but also serves to define the basis functions. The nodes $a$ consist of those nodes in the discretization that do not lie on $\partial_u\kappa_0$. We assume from here on that the displacement boundary conditions are homogeneous, for simplicity.

The basis functions are globally continuous functions that exhibit important features in a finite element setting, namely: 1) \textit{compact support}, meaning $\phi_a$ is nonzero only on elements that contain node $a$; 2) the \textit{Kronecker delta} property, meaning $\phi_a(\bm{X}_b) = \delta_{ab}$, where $b$ is another node in the reference configuration; and 3) \textit{partition of unity}, meaning $\sum\limits_a\phi_a(\bm{X}) = 1$ throughout the body.

Utilization of the approximations to $\bm{u}$ and $\bm{w}$, and the fact that equilibrium must hold for any choice of $\bm{w}_a$ as long as $\bm{w} \in \mathcal{V}$, leads to the finite element approximation to the weak form of equilibrium, known as the \textit{residual equations}:
\begin{equation}
R_{ia} = \int_{\kappa_0}P_{ij}\phi_{a,j}dV - \int_{\kappa_0}\rho_0b_i\phi_adV - \int_{\partial_t\kappa_0} \overline{p}_i\phi_adA = 0.
\label{eqn:elresid}
\end{equation}
Shape functions and integrals are all performed in the \textit{reference configuration}, making this a \textit{total Lagrangian} formulation. Performing all integrals in the reference configuration allows the basis function derivatives to be stored, rather than recomputed for each iteration of each solution step. It also simplifies derivatives of integrals over the body because the integral domain does not depend on the solution. The global residual equations are a nonlinear system of equations, solved in steps to ensure equilibrium is enforced throughout the quasistatic loading.

\subsection{Solution of the Nonlinear Residual Equations}

The solution to the global residual equations is advanced from one equilibrium state to the next as the loading is incrementally applied, until the final equilibrium state is reached for the quasistatic problem. Assuming equilibrium has been established for time $t_n$, we seek to find equilibrium for time $t_{n+1}$ through the time step $\Delta = t_{n+1} - t_{n}$. The \textit{beginning step} will refer to $t_n$ and the \textit{end step} to $t_{n+1}$. Define the position $\overline{\bm{x}} = \bm{x}(\bm{X},t_n)$, and for the forthcoming purposes we refer to ${\bm{x}}$ specifically as $\bm{x}(\bm{X},t_{n+1})$. Define ${\bm{u}}^* = \overline{\bm{x}} - \bm{X}$. In order to solve for displacements $\bm{u} = \bm{x} - \bm{X}$ at time $t_{n+1}$, the incremental displacements $\hat{\bm{u}} = \bm{x} - \overline{\bm{x}}$ are needed so that $\bm{u}$ can be updated via $\bm{u} = {\bm{u}}^* + \hat{\bm{u}}$. Thus, when seeking to update from time $t_n$ to $t_{n+1}$, we seek the incremental displacements $\hat{\bm{u}}$ such that the global residual equations are satisfied at time $t_{n+1}$, within a specified tolerance.

The most common approach to solving the nonlinear system of equations is via a \textit{Newton-Raphson} iterative scheme. The solution of $\bm{R}_a(t_{n+1}) = \bm{0}$ is performed via successive solution of the following \textit{linearized global residual equations}:
\begin{equation}
\frac{\partial R_{ia}}{\partial \hat{u}_{jb}} \bigg|_{k+1} \delta\hat{u}_{jb} = -R_{ia}\bigg|_{k+1},
\label{eqn:newtonraphson}
\end{equation}
where:
\begin{equation}
\delta\hat{\bm{u}} = \hat{\bm{u}}\big|_{k+1} - \text{\ }\hat{\bm{u}}\big|_k,
\end{equation}
and $k$ is the iteration number. When applied successfully, the procedure iterates and corrects the incremental nodal displacements until they satisfy the residual equations. Provided appropriate time steps and convergence criteria, the scheme should in practice converge to the solution ideally in only a handful of iterations.

Populating and solving the linearized residual equations requires computing the following two terms: $\frac{\partial R_{ia}}{\partial \hat{u}_{jb}} \big|_{k+1}$ and $R_{ia}\big|_{k+1}$. The nodal residuals have been defined previously in \eqnref{elresid}. For a constant reference density, and assuming the body force is not a function of displacement, the tangent stiffness is:
\begin{equation}
\frac{\partial R_{ia}}{\partial \hat{u}_{jb}} = \int_{\kappa_0}\frac{\partial P_{ik}}{\partial \hat{u}_{jb}}\phi_{a,k}dV - \int_{\partial_t\kappa_0}\frac{\partial \overline{p}_i}{\partial \hat{u}_{jb}}\phi_adA.
\end{equation}
Note, because the integrals are performed in the reference configuration, the derivatives are moved past the integral signs and applied directly to the integrands. The manner in which the integrals in these terms are performed is based on the discretization of the body $\mathcal{B}$ into a discrete \textit{mesh} of finite elements. The calculation of $P_{ij}$ and $\partial{P}_{ik}/\partial{\hat{u}_{jb}}$ relies on a careful treatment of the \textit{constitutive update} and corresponding material model. The calculation of $\overline{p}_i$ and $\partial{\overline{p}_i}/\partial{\hat{u}_{jb}}$ corresponds to the choice of traction \textit{boundary conditions}. Each of these three important components to FEM are discussed next.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Mesh Considerations}

The integrals in the linearized residual equations are performed on an element level and subsequently combined to form the global residual and tangent stiffness terms. Integrals over a single element domain $\Omega_e \subseteq \kappa_0$ have the same form as those defining $\frac{\partial R_{ia}}{\partial \hat{u}_{jb}} \big|_k$ and $R_{ia}\big|_k$, with the exception that integrals are performed over $\Omega_e$ instead of $\kappa_0$. Thus, for each element, the quantities $\frac{\partial R^e_{ia}}{\partial \hat{u}_{jb}} \big|_k$ and $R^e_{ia}\big|_k$ are of interest.

Via the spatial discretization of $\mathcal{B}$ into elements, basis functions are decomposed into element \textit{shape functions} defined on each of the neighboring elements to the node $a$ for which $\phi_a$ is defined. Those shape functions are used to compute volume and facet integrals via an \textit{isoparametric transformation} from the physical space to a \textit{parent space}, in the following manner:
\begin{equation}
\bm{X}(\bm{\xi}) = \sum\limits_{a}\bm{X}_a{N}_a(\bm{\xi}),
\end{equation}
where $\bm{X}_a$ are spatial coordinates of the element nodes, $N_a$ are the shape functions, and $\bm{\xi}$ is the position vector in the parent element domain. The transformation is \textit{isoparametric} because the same shape functions are used to interpolate nodal displacements.

Thus, the element-level residual and tangent stiffness equations take the following form:
\begin{gather}
R^e_{ia} = \int_{\Omega_e}P_{ij}N_{a,j}dV - \int_{\Omega_e}\rho_0b_iN_adV - \int_{\partial_t\Omega_e} \overline{p}_iN_adA = 0, \label{eqn:elr} \\[0.7em]
\frac{\partial R^e_{ia}}{\partial \hat{u}_{jb}} = \int_{\Omega_e}\frac{\partial P_{ik}}{\partial \hat{u}_{jb}}N_{a,k}dV - \int_{\partial_t\Omega_e}\frac{\partial \overline{p}_i}{\partial \hat{u}_{jb}}N_adA. \label{eqn:elt}
\end{gather}

The \textit{order} of an element corresponds to the polynomial degree of its corresponding shape functions. Refer to Hughes~\cite{hughes_2000} for a definition of the shape functions $N_a$ for linear and quadratic tetrahedral and hexahedral elements. 

Volume and facet integrals are evaluated via numerical quadrature rules on the parent element and subsequently \textit{assembled} into the linearized global residual equations. Because the shape functions $N_a$ are functions of parent space coordinates $\bm{\xi}$, integrands are computed in the parent space and the corresponding differential element is scaled to correspond to the physical reference configuration. For volume integrals, the differential volume $dv = {d\xi}{d\eta}{d\zeta}$ is scaled by the determinant of the Jacobian of the isoparametric transformation to acquire the desired $dV$ in the physical space. Namely $J_v = \det(\frac{\partial{\bm{X}}}{\partial\bm{\xi}})$ and $dV = J_vdv$. A two-dimensional analog applies for facet integrals, in which we define $da = {d\xi}{d\eta}$, $J_f = \det(\frac{\partial{\bm{X}}}{\partial\bm{\xi}})$, and $dA = J_fda$. In this case, $\bm{\xi}$ is a two-dimensional parameterization of the particular facet of interest.

Lastly, performing the volume integral of the stress-divergence term requires computing shape function gradients $N_{a,k} = \frac{\partial N_a}{\partial X_k}$ in the physical space. We may write the derivatives in terms of parent-space derivatives in the following manner:
\begin{equation}
\frac{\partial N_a}{\partial \bm{X}} = \left(\frac{\partial \bm{X}}{\partial \bm{\xi}}\right)^{\hspace{-0.3em}-T} \hspace{0.05em} \frac{\partial N_a}{\partial \bm{\xi}}.
\end{equation}
For conventional FEM, the quality of the approximating solution depends critically on the ability to map spatial coordinates of an element to its parent space with high fidelity. Thus, the notion of \textit{mesh quality} is an important consideration for automated meshing tools if the resultant mesh is to be provided to a conventional FEM code. Mesh quality metrics attempt in various ways to measure the distortion of physical elements from their corresponding parent elements. Refer to the CUBIT User Documentation~\cite{cubit_2018} for an in-depth description of mesh quality metrics.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Constitutive Update}

The constitutive update involves updating the \textit{material state} from time $t_n$ to $t_{n+1}$ at each integration point of each element in $\mathcal{B}$. Provided the motion from $\kappa_n$ to $\kappa_{n+1}$, we seek to update all \textit{state variables} based \textit{only} on their values at $t_n$, independent of choice of reference configuration. More specifically, provided incremental displacements $\hat{\bm{u}} = \bm{u} - \bm{u}^*$ from $t_n$ to $t_{n+1}$, $P_{ij}$ evaluated at $t_n$, and state variables defined at $t_n$, we seek to determine $P_{ij}$, $\partial{P_{ik}}/\partial{\hat{u}_{jb}}$, and state variables at time $t_{n+1}$. The terms $P_{ij}$ and $\partial{P_{ik}}/\partial{\hat{u}_{jb}}$ are used to compute element-level volume integrals to ultimately populate the linearized global residual equations. State variables may take many forms depending on the material model, such as \textit{plastic strain}, \textit{back stress}, or even the deformation gradient itself. In conjunction with the stress state, the state variables should fully describe the current state of the material at that particular location.

The following discussion will center around the kinematics, material update, and subsequent contribution to the linearized residual equations for \textit{hypoelastic} materials. Hypoelastic materials are typically defined as a rate form of the Cauchy stress in terms of stretch rate $\bm{D}$:
\begin{equation}
\overset{\circ}{\bm{T}} =  {\mathbfcal{C}}\bm{D}.
\end{equation}
The quantity ${\mathbfcal{C}}$ is an isotropic rank-four \textit{modulus tensor}. The \textit{Jaumann rate} of stress $\overset{\circ}{\bm{T}} = \dot{\bm{T}} + \bm{T}\bm{W} - \bm{W}\bm{T}$ is known as a \textit{co-rotational} or \textit{objective} stress rate because it behaves as $\bm{Q}\overset{\circ}{\bm{T}}\bm{Q}^T$ under a superposed rigid rotation $\bm{Q}$. Among the various objective stress rates, the Jaumann rate is chosen because it respects the notion of material state, i.e., it does not depend on any reference configuration. See Rashid for a more complete discussion on material state and its relationship to objective stress rates~\cite{rashid_1991}.

In such an incremental approach, the desired input kinematic quantities are the strain increment $\bm{D}\Delta$ and rotation increment $\hat{\bm{R}}$. Rashid's incremental kinematics algorithm~\cite{rashid_1993} computes these quantities in a manner that allows accurate updates to the material state in the presence of large increments of stretch and rotation. The algorithm will be summarized herein, as it pertains to the constitutive update to hypoelastic materials. The material model is defined in terms of Cauchy stress, but the residual and tangent stiffness terms are defined in terms of the first P-K stress, so additional considerations are required to convert relevant quantities from one stress measure to the other. The following discussion will touch upon all of these details. Because material models in biological applications tend not to be defined in an incremental sense, strategies for applying this framework to \textit{hyperelastic} materials are also covered. Finally, a brief comment on treatment of material incompressibility constraints is discussed.

\subsubsection{Incremental Kinematics}

A faithful treatment of incremental kinematics depends critically on the assumed deformation history through a time step as the material state is updated from time $t_n$ to $t_{n+1}$. Rashid~\cite{rashid_1993} assumed the path is separated into two discrete motions: a pure stretching motion at constant stretch rate $\bm{D}$, followed by an instantaneous rotation $\hat{\bm{R}}$. This assumed motion proves to generate accurate stress updates in the presence of simultaneously large stretch and rotation increments, which is not the case for other popular incremental kinematics approaches~\cite{rashid_1996}. Some preliminary kinematic quantities will be defined, followed by an algorithm to compute the approximate polar decomposition of $\hat{\bm{F}}$ to acquire $\bm{D}$ and $\hat{\bm{R}}$. Finally, the subsequent steps are detailed to use this assumed deformation path within the context of element contributions to residual and tangent stiffness terms for a linear hypoelastic material.

\textbf{Kinematics Quantities}

Given the incremental displacements $\hat{\bm{u}}$, we seek to compute the quantities $\bm{D}$ and $\hat{\bm{R}}$. Much in the same way we approximate $\bm{u}$ by a linear combination of shape functions $\phi_a$, we make the same approximations for $\bm{u}^*$ and $\hat{\bm{u}}$. Since we are concerned with element-level computations here, the definitions will shift from using basis functions $\phi_a$ to using shape functions $N_a$:
\begin{align}
u_i = u_{ia}N_a, \qquad u^*_i &= u^*_{ia}N_a, \qquad \hat{u}_i = \hat{u}_{ia}N_a \\
u_{i,j} = u_{ia}N_{a,j}, \qquad u^*_{i,j} &= u^*_{ia}N_{a,j}, \qquad \hat{u}_{i,j} = \hat{u}_{ia}N_{a,j}.
\end{align}
Note, the nodal values are only functions of time, and not of reference configuration position. Because this is a total Lagrangian approach, the quantities $N_a$ and $N_{a,j}$ do not depend on the solution and need only be computed once for each integration point for the entire simulation.

The corresponding deformation gradients of interest are then defined as:
\begin{equation}
\bm{F} = \frac{\partial \bm{x}}{\partial \bm{X}}, \qquad \overline{\bm{F}} = \frac{\partial \overline{\bm{x}}}{\partial \bm{X}}, \qquad \hat{\bm{F}} = \frac{\partial \bm{x}}{\partial \overline{\bm{x}}}.
\end{equation}
Thus, $\bm{F}$ can be decomposed as:
\begin{equation}
\bm{F} = \hat{\bm{F}}\overline{\bm{F}}.
\end{equation}
It can be shown that the deformation gradients can be written in terms of the nodal displacements and shape function gradients in the following form:
\begin{align}
F_{ij} &= \delta_{ij} + \left(u^*_{ia} + \hat{u}_{ia} \right) N_{a,j} = \delta_{ij} + \left(u^*_{ia} + \hat{u}_{ia} \right) B_{ja}, \\
\overline{F}_{ij} &= \delta_{ij} + u^*_{ia} N_{a,j} = \delta_{ij} + u^*_{ia} B_{ja},
\end{align}
where $B_{ja} = N_{a,j}$ are the components of the shape function gradient for node a and element $e$, evaluated at $t_{n+1}$, and $\delta_{ij}$ are the components of the Kronecker delta.

As previously mentioned, the velocity gradient is defined as $\bm{L} = \frac{\partial \bm{u}}{\partial \bm{x}} = \dot{\bm{F}}\bm{F}^{-1} = \bm{D} + \bm{W}$. In the absence of rotation, $\dot{\bm{F}}\bm{F}^{-1} = \dot{\bm{U}}\bm{U}^{-1}$ and $\bm{L} = \bm{D}$. Combining results yields $\dot{\bm{U}}\bm{U}^{-1} = \bm{D}$. Assuming a constant rate of stretch, the calculation of the rate-of-stretch tensor involves solving the following ODE:
\begin{align}
&\dot{{\bm{U}}} = {\bm{D}}{\bm{U}}, \qquad t\in (t_n, t_{n+1}), \\
&{\bm{U}}\left(t_n\right) = \bm{I}.
\end{align}
Solving the ODE and imposing the desired ${\bm{U}}(t_{n+1}) = \hat{\bm{U}}$ yields $\hat{\bm{U}} = \text{exp}(\bm{D}\Delta)$. Performing a Taylor expansion about $\hat{\bm{U}} = \bm{I}$ and making use of the right Cauchy-Green deformation tensor $\hat{\bm{C}} = \hat{\bm{U}}^2$ yields the following result: 
\begin{equation}
{\bm{D}}\Delta \approx -\frac{1}{2}(\hat{\bm C}^{-1} - {\bm{I}})+ \frac{1}{4} (\hat{\bm{C}}^{-1} - {\bm{I}})^{2} - \frac{1}{6} (\hat{\bm{C}}^{-1} - {\bm{I}})^{3}.
\end{equation}

The assumption that $\hat{\bm{U}}$ is near $\bm{I}$ is valid as long as the time steps are chosen so that the stretch in each time step is relatively small. Because $\hat{\bm{C}}^{-1}$ is close to identity, we define it in terms of $\bm{A} = \bm{I} - \hat{\bm{F}}^{-1} = \bm{I} - \overline{\bm{F}}\bm{F}^{-1}$ to avoid floating point precision issues. The strain increment is then computed as follows:
\begin{gather}
\hat{\bm C}^{-1} - {\bm I} = \bm{A} \bm{A}^T - \bm{A} - \bm{A}^T, \\
{\bm D}\Delta = -\frac{1}{2}(\hat{\bm C}^{-1} - {\bm I})+ \frac{1}{4} (\hat{\bm C}^{-1} - {\bm I})^{2} - \frac{1}{6} (\hat{\bm C}^{-1} - {\bm I})^{3}.
\end{gather}
With the strain increment now formed, what remains is the rotation increment. The calculation of the incremental rotation $\hat{\bm{R}}$ is approximated in the following manner:
\begin{equation}
\hat{R}_{ij} = \delta_{ij}\cos\theta + \frac{1 - \cos \theta}{4Q}\alpha_i\alpha_j - \frac{\sin\theta}{2\sqrt{Q}}\varepsilon_{ijk}\alpha_{k},
\end{equation}
where $\theta$ is the rotation angle, $\boldsymbol{\alpha}$ is an intermediate quantity, $\boldsymbol{\varepsilon}$ is the alternator symbol, and $Q  =\frac{1}{4}\bm{\alpha} \bm{\cdot} \bm{\alpha}$. Special care is observed when $Q$ is close to zero. Refer to Rashid~\cite{rashid_1993} for a complete description of how the rotation increment is formed. Importantly, this approximation retains proper orthogonality of $\hat{\bm{R}}$.

Thus, the stretch rate $\bm{D}$ and incremental rotation $\hat{\bm{R}}$ have been defined in an incrementally objective manner, provided the input incremental displacement $\hat{\bm{u}}$.  It should be noted that the actual polar decomposition of $\hat{\bm{F}} = \hat{\bm{R}}\hat{\bm{U}}$ may be computed at more computational cost. The additional accuracy from an exact polar decomposition may come in use for increments involving particularly large stretches and rotations, but for most practical purposes the accuracy of the algorithm via an approximated polar decomposition is sufficient~\cite{rashid_1993}.

\textbf{Element Contribution to the Linearized Global Residual Equations}

The quantities $\bm{D}$ and $\hat{\bm{R}}$ are used in conjunction with the material model to compute $P_{ij}$ in the element residual equations. This is accomplished by computing the end step \textit{unrotated} Cauchy stress $\tilde{\bm{T}}$, forward-rotating it by $\hat{\bm{R}}$ to compute $\bm{T}$, and finally converting the Cauchy stress to the first P-K stress $\bm{P}$.

For a demonstration on how to utilize the kinematics algorithm within a finite element framework, we will address the linear hypoelastic material defined by $\overset{\circ}{\bm{T}} = \bm{\mathcal{C}}\bm{D}$. Provided $\bm{D}$, we seek to integrate the stress rate in order to update the beginning step stress $\overline{\bm{T}}$. Note that the constitutive update subroutine itself is executed completely independently of $\hat{\bm{R}}$; the rotation occurs \textit{after} the update. In the absence of rotation, i.e., $\bm{W} = \bm{0}$, the Jaumann rate reduces to the time rate and the material model simplifies to $\dot{\bm{T}} = \mathbfcal{C}\bm{D}$. Provided the beginning step Cauchy stress $\overline{\bm{T}}$, the end step unrotated stress is computed via $\tilde{\bm{T}} = \overline{\bm{T}} + \mathbfcal{C}\bm{D}\Delta$. The subroutine must also provide the \textit{tangent modulus} $\partial\tilde{\bm{T}}/\partial({\bm{D}\Delta}$), which for the case of a linear hypoelastic material is simply $\mathbfcal{C}$. For the purposes of such an incremental framework, the term $\mathbfcal{C}\bm{D}\Delta$ may be viewed as an incremental stress $\hat{\bm{T}}$. The stress is then forward rotated by $\hat{\bm{R}}$:
\begin{equation}
\bm{T} = \hat{\bm{R}}\tilde{\bm{T}}\hat{\bm{R}}^T.
\end{equation}
Finally, the first P-K stress is computed via $\bm{P} = J\bm{T}\bm{F}^{-T}$.

For the contribution at a particular integration point of an element to the tangent stiffness terms, the quantity $\partial{\bm{P}}/\partial{\hat{\bm{u}}}$ is desired. This term must be computed in a manner \textit{consistent} with the constitutive update algorithm to ensure desirable convergence behavior of the Newton-Raphson scheme. Namely, this term should ideally reflect the derivative of the end step stress $\bm{P}$ \textit{as it is computed} with respect to incremental displacements $\hat{\bm{u}}$, as opposed to an analytic computation insensitive to the approximations made for the kinematic input, or a numerically approximated value via finite differences.

The derivatives are performed in a lengthy but relatively straightforward manner. Using the product rule:
\begin{equation}
\frac{\partial {\bm P}}{\partial \hat{{\bm u}}} = \frac{\partial J}{\partial \hat{\bm u}}{\bm T}{\bm F}^{-T} + J\frac{\partial {\bm T}}{\partial \hat{\bm u}}{\bm F}^{-T} + J{\bm T}\frac{\partial {\bm F}}{\partial \hat{\bm u}}^{-T}.
\end{equation}
Thus, the terms of interest are ${\partial J}/{\partial \hat{\bm{u}}}$, ${\partial \bm{T}}/{\partial \hat{\bm{u}}}$, and ${\partial \bm{F}^{-T}}/{\partial \hat{\bm{u}}}$. The requisite terms to compute the derivative of the first P-K tensor with respect to incremental nodal displacements follow:
\begin{gather}
\frac{\partial J}{\partial F_{kl}} = JF_{lk}^{{-1}}, \\
\frac{\partial F_{ij}}{\partial \hat{u}_{ka}} = \delta_{ik}\delta_{pa}B_{jp}, \\
\frac{\partial J}{\partial \hat{u}_{ka}} = JF_{pk}^{-1}B_{pa}, \\
\frac{\partial F_{ij}^{-1}}{\partial F_{kl}} = - F_{ik}^{-1}F_{lj}^{-1}, \\
\frac{\partial F_{ij}^{-1}}{\partial \hat{u}_{ka}} = - F_{ik}^{-1}B_{pa}F_{pj}^{-1}, \\
A_{ij} = \hat{u}_{ia}B_{ka}F^{-1}_{kj}, \\
\hat{{\bm C}}^{-1} = {\bm I} - {\bm A} - {\bm A}^T + {\bm A}{\bm A}^T, \\
\frac{\partial A_{ij}}{\partial \hat{u}_{ka}} = \hat{F}^{-1}_{ik}B_{pa}F^{-1}_{pj}, \\
\frac{\partial \hat{C}^{-1}_{ij}}{\partial \hat{A}_{kl}} = -\delta_{ik}\delta_{jl} - \delta_{jk}\delta_{il} + \delta_{ik}A_{jl} + A_{il}\delta_{jk},
\end{gather}
\vspace{-15mm}
\begin{equation}
\begin{aligned}
\frac{\partial ({\bm D}\Delta)}{\partial {\bm A}} = &-\frac{1}{2}\frac{\partial {\hat{\bm C}^{-1}}}{\partial \bm A} + \frac{1}{4}({\hat{\bm C}}^{-1} - {\bm I})\frac{\partial \hat{\bm C}^{-1}}{\partial {\bm A}} + \frac{1}{4}\frac{\partial \hat{\bm C}^{-1}}{\partial {\bm A}}({\hat{\bm C}}^{-1} - {\bm I}) \\
&-\frac{1}{6} \frac{\partial {\hat{\bm C}^{-1}}}{\partial \bm A} (\hat{\bm C}^{-1} - {\bm I})^{2} - \frac{1}{6}  (\hat{\bm C}^{-1} - {\bm I}) \frac{\partial {\hat{\bm C}^{-1}}}{\partial \bm A} (\hat{\bm C}^{-1} - {\bm I}) \\
&- \frac{1}{6}(\hat{\bm C}^{-1} - {\bm I})^{2} \frac{\partial {\hat{\bm C}^{-1}}}{\partial \bm A},
\end{aligned}
\end{equation}
\begin{gather}
\frac{\partial (D_{ij}\Delta)}{\partial \hat{u}_{ka}} = \frac{\partial (D_{ij}\Delta)}{\partial A_{mn}}\frac{\partial A_{mn}}{\partial \hat{u}_{ka}}, \\
\frac{\partial \hat{R}_{ij}}{\partial A_{mn}} = \frac{1}{2}(-\delta_{in}\delta_{jm} + \hat{R}_{im}\hat{R}_{nj}), \\
\frac{\partial \hat{R}_{ij}}{\partial \hat{u}_{ka}} = \frac{1}{2}\left(-\hat{F}_{jk}^{-1}(F_{pi}^{-1}B_{pa}) + \hat{R}_{im}\hat{F}_{mk}^{-1}\hat{R}_{nj}(F_{pn}^{-1}B_{pa})\right), \\
\frac{\partial \tilde{\bm T}}{\partial \hat{\bm u}} = \frac{\partial \tilde{\bm T}}{\partial ({\bm D}\Delta)}\frac{\partial ({\bm D}\Delta)}{\partial \hat{\bm u}}.
\end{gather}
Finally, the derivative is forward-rotated by the incremental rotation:
\begin{equation}
\frac{\partial {\bm T}}{\partial \hat{\bm u}} = \frac{\partial \hat{\bm R}}{\partial \hat{\bm u}}{\tilde {\bm T}}{\hat{\bm R}}^{T} + {\hat{\bm R}}\frac{\partial \tilde{\bm T}}{\partial \hat{\bm u}}\hat{\bm R}^T + \hat{\bm R}\tilde{\bm T}\frac{\partial \hat{\bm R}^{T}}{\partial \hat{\bm u}}.
\end{equation}
Note the calculation of ${\partial \hat{R}_{ij}}/{\partial A_{mn}}$ makes use of the assumption that $\hat{\bm{U}} \approx \bm{I}$.

Thus, the end step first P-K stress and its derivative with respect to incremental nodal displacements have been computed, and via isoparametric mapping and numerical quadrature, the element level residual and tangent stiffness integrals can be populated. Those terms are then assembled into the residual equations and solved to advance the solution to the next time step.

\subsubsection{Hyperelastic Materials}

Hyperelastic material models describe nonlinear elastic behavior under finite deformations. They are commonly utilized to model the mechanical behavior of biological or rubber-like materials. A body comprised of a hyperelastic material that undergoes mechanical deformation is an example of a  \textit{conservative system}, and thus the stress may be written as a function of a \textit{strain energy potential} $W$. Indeed, hyperelastic materials are typically defined by the strain energy, rather than by a particular stress measure.

For hyperelastic materials, the strain energy $W$ is typically defined as a function of the deformation gradient $\bm{F}$ or a related kinematic quantity, from which the stress may be computed via its relationship with $W$. In the context of a constitutive update, in contrast to the hypoelastic case, the only kinematic quantity required to compute the Cauchy stress $\bm{T}$ is the end step deformation gradient $\bm{F}$. For the purposes of the linearized residual equations, rather than the tangent modulus ${\partial \tilde{\bm{T}}}/{\partial (\bm{D}\Delta)}$, the quantity ${\partial \bm{T}}/{\partial \bm{F}}$ may be computed instead. Computing the inner product of ${\partial \bm{T}}/{\partial \bm{F}}$ with $\partial \bm{F}/\partial \hat{\bm{u}}$ finally yields the desired quantity $\partial \bm{T}/\partial \hat{\bm{u}}$. In this manner, no forward rotation of the end step stress or tangent modulus is necessary.

A hyperelastic material may still be implemented within the incremental kinematics framework that has been discussed, however. This may be desirable if it is preferred that the finite element codebase treat all materials in the same way, as opposed to computing the constitutive update and contributions to the residual equations in a fundamentally different way for hyperelastic vs. hypoelastic materials. In order to accomplish this task, the deformation gradient is stored as a state variable. Care must then be taken to accurately update the deformation gradient in the constitutive update, and to subsequently forward-rotate it afterwards. The details are henceforth described for an implementation of the Mooney-Rivlin hyperelastic material model as a means of demonstration.

\textbf{Material Model Definition}

A compressible Mooney-Rivlin material is defined by the following relationship:
\begin{align}
W = C_1(\overline{I}_1 - 3) + C_2(\overline{I}_2 - 3) + D_1(J - 1)^2,
\end{align}
where $W$ is the strain energy density, $C_1$ and $C_2$ are constants related to distortional response, and $D_1$ is a constant related to volumetric response. The deformation quantities are $\overline{I}_1 = J^{-2/3}I_1$ and $\overline{I}_2 = J^{-4/3}I_2$, where $I_1$ and $I_2$ are the first and second invariants of $\bm{B} = {\bm F}{\bm F}^T$. Specifically, $I_1 = \lambda_1^2 + \lambda_2^2 + \lambda_3^2$ and $I_2 = \lambda_1^2\lambda_2^2 + \lambda_2^2\lambda_3^2 + \lambda_1^2\lambda_3^2 = \frac{1}{2}[(\text{tr}{\bm B})^2 - \text{tr}({\bm B}^2)]$, where $\lambda_i$ are the eigenvalues of the deformation gradient ${\bm F}$.

The relationship between Cauchy stress ${\bm T}$ and strain energy density $W$ is as follows:
\begin{align}
{\bm T} = \frac{1}{J}\frac{\partial W}{\partial {\bm F}}{\bm F}^{T}.
\end{align}
Using this relationship, one may obtain a direct expression for the Cauchy stress ${\bm T}$ in terms of the deformation gradient:
\begin{align}
{\bm T} = \frac{2}{J}\left[\frac{1}{J^{2/3}}(C_1 + \overline{I}_1{C_2}){\bm B} - \frac{1}{J^{4/3}}C_2{\bm B}^2\right] + \left[2D_1(J-1) - \frac{2}{3J}(C_1\overline{I}_1 + 2C_2\overline{I}_2)\right]{\bm I},
\end{align}
which can be written in index notation as:
\begin{align}
T_{ij} = \frac{2}{J}\left[\frac{1}{J^{2/3}}(C_1 + \overline{I}_{1}C_2)B_{ij} - \frac{1}{J^{4/3}}C_2B_{ik}B_{kj}\right] + \left[2D_1(J-1) - \frac{2}{3J}(C_1\overline{I}_{1} + 2C_2\overline{I}_{2})\right]\delta_{ij}.
\end{align}
Using the relationships $\overline{I}_{1} = J^{-2/3}I_1$ and $\overline{I}_{2} = J^{-4/3}I_2$ and reorganizing, the relationship that will be used moving forward is as follows:
\begin{align}
\label{eqn:stress}
T_{ij} = 2C_1J^{-5/3}\left[B_{ij} - \frac{1}{3}I_1\delta_{ij}\right] + 2C_2J^{-7/3}\left[I_1B_{ij} - B_{im}B_{mj} - \frac{2}{3}I_2\delta_{ij}\right] + 2D_1(J-1)\delta_{ij}.
\end{align}
In the limit of small strains, this reduces to a linear elastic material if the bulk modulus $K = 2D_1$ and the shear modulus $\mu = 2(C_1 + C_2)$.

\textbf{Stress Update}

Much in the same way as is done in the hypoelastic case, we define the following:
\begin{align}
\hat{\bm {U}} &= {\bm I} + {\bm D} + \frac{1}{2}{\bm D}^2 + \frac{1}{6}{\bm D}^3,
\end{align}
where we have redefined ${\bm D}\leftarrow{\bm D}\Delta$ for convenience.

We now define $\tilde {\bm F}$ as the deformation gradient at time $t_{n+1}$ prior to applying the rotation increment $\hat{\bm R}$. Specifically,
\begin{align}
\tilde {\bm F} = \hat{\bm U}\overline{\bm F}, \\
{\bm F} = \hat{\bm R}\tilde {\bm F}.
\end{align}
When calculating stresses for the new time step, rather than feed ${\bm F}$ into the constitutive update to calculate ${\bm T}$, we feed $\bm{D}$ to calculate $\tilde{\bm{T}}$ as is done for hypoelastic materials. This requires $\overline {\bm F}$ to be stored as a state variable, which is accordingly updated at the beginning of the constitutive routine via $\tilde {\bm F} = \hat{\bm U}\overline{\bm F} $. The quantity $\tilde{\bm{F}}$ is used to compute $\tilde{\bm T}$ via \eqnref{stress}. Note that $\tilde{\bm{T}}$ is computed based only on $\tilde{\bm{F}}$. It is not computed by incrementing $\overline{\bm{T}}$ as is done for hypoelasticity. Finally, outside of the constitutive update subroutine, the end step unrotated Cauchy stress and deformation gradient are forward rotated in the following manner:
\begin{gather}
{\bm T} = \hat{\bm R}\tilde{\bm T}\hat{\bm R}^T, \\
\bm{F} = \hat{\bm{R}}\tilde{\bm{F}}.
\end{gather}

\textbf{Tangent Modulus}

When stepping from time $t_n$ to $t_{n+1}$, we seek the derivative $\partial{\tilde{\bm T}}/\partial {\bm D}$, where ${\bm D}$ retains its redefinition as stretch rate \textit{multiplied by the time step}. Successive use of chain rule will be used to compute $\partial \tilde{\bm{T}}/\partial{\bm{D}}$ as follows:
\begin{equation}
\frac{\partial \tilde{\bm T}}{\partial \bm D} = \frac{\partial \tilde{\bm T}}{\partial \tilde{\bm F}}\frac{\partial \tilde{\bm F}}{\partial {\hat {\bm U}}}\frac{\partial \hat{\bm U}}{\partial {\bm D}}.
\label{eq:tanmod}
\end{equation}
The following tensor derivatives will be used repeatedly in what follows:
\begin{align}
\text{if } {\bm A} \neq {\bm A}^T\text{,}\ \ \ &\frac{\partial A_{ij}}{\partial A_{kl}} = \delta_{ik}{\delta_{jl}}, \\
\text{if } {\bm A} = {\bm A}^T\text{,}\ \ \ &\frac{\partial A_{ij}}{\partial A_{kl}} = \frac{1}{2}(\delta_{ik}{\delta_{jl}} + \delta_{il}{\delta_{jk}}).
\end{align}
Importantly, these derivatives are not the same for symmetric and nonsymmetric tensors.

The Taylor expansion definition of $\hat{\bm U}$ from the previous section is repeated here in index notation:
\begin{align}
\hat{U}_{ij} &= \delta_{ij} + D_{ij} + \frac{1}{2}D_{im}D_{mj} + \frac{1}{6}D_{im}D_{mn}D_{nj}.
\end{align}
The derivative $\partial \hat{\bm U}/{\partial {\bm D}}$ is then:
\begin{equation}
\begin{split}
\frac{\partial \hat{U}_{ij}}{\partial D_{kl}} = &\frac{1}{2}\left[\delta_{ik}\delta_{jl} + \frac{1}{2}\delta_{ik}\delta_{ml}D_{mj} + \frac{1}{2}D_{im}\delta_{mk}\delta_{jl}\  + \right.\\
&\ \left.\ \ \frac{1}{6}\delta_{ik}\delta_{ml}D_{mn}D_{nj} + \frac{1}{6}D_{im}\delta_{mk}\delta_{nl}D_{nj} + \frac{1}{6}D_{im}D_{mn}\delta_{nk}\delta_{jl}\right] + \\
&\frac{1}{2}\left[\delta_{il}\delta_{jk} + \frac{1}{2}\delta_{il}\delta_{mk}D_{mj} + \frac{1}{2}D_{im}\delta_{ml}\delta_{jk}\  + \right.\\
&\ \left.\ \ \frac{1}{6}\delta_{il}\delta_{mk}D_{mn}D_{nj} + \frac{1}{6}D_{im}\delta_{ml}\delta_{nk}D_{nj} + \frac{1}{6}D_{im}D_{mn}\delta_{nl}\delta_{jk}\right].
\end{split}
\end{equation}
Further simplifying,
\begin{align}
\frac{\partial \hat{U}_{ij}}{\partial D_{kl}} = &\frac{1}{2}\left[\delta_{ik}\delta_{jl} + \frac{1}{2}\delta_{ik}D_{lj} + \frac{1}{2}D_{ik}\delta_{jl} + \frac{1}{6}\delta_{ik}D_{ln}D_{nj} + \frac{1}{6}D_{ik}D_{lj} + \frac{1}{6}D_{im}D_{mk}\delta_{jl}\right] + \\
&\frac{1}{2}\left[\delta_{il}\delta_{jk} + \frac{1}{2}\delta_{il}D_{kj} + \frac{1}{2}D_{il}\delta_{jk} + \frac{1}{6}\delta_{il}D_{kn}D_{nj} + \frac{1}{6}D_{il}D_{kj} + \frac{1}{6}D_{im}D_{ml}\delta_{jk}\right].
\end{align}

Now, repeating the definition for $\tilde {\bm F}$ in index notation:
\begin{align}
\tilde{F}_{ij} = \hat{U}_{im}\overline{F}_{mj}.
\end{align}
The derivative ${\partial \tilde{\bm F}}/{\partial \hat{\bm U}}$ is:
\begin{align}
\frac{\partial \tilde{F}_{ij}}{\partial \hat{U}_{kl}} = \frac{1}{2}\left(\delta_{ik}\delta_{ml}\overline{F}_{mj} + \delta_{il}\delta_{mk}\overline{F}_{mj}\right),
\end{align}
and simplifying:
\begin{align}
\frac{\partial \tilde{F}_{ij}}{\partial \hat{U}_{kl}} &= \frac{1}{2}\left(\delta_{ik}\overline{F}_{lj} + \delta_{il}\overline{F}_{kj}\right).
\end{align}

With $\partial \tilde{\bm F}/\partial \hat{\bm U}$ and $\partial \hat{\bm U}/\partial {\bm D}$ specified, $\partial \tilde{\bm T}/\partial \tilde {\bm F}$ remains in order to compute the tangent modulus $\partial \tilde{\bm T}/\partial {\bm D}$. We may write the derivative as follows:
\begin{align}
\frac{\partial \tilde{\bm T}}{\partial \tilde{\bm F}} &= \frac{\partial \tilde{\bm T}}{\partial J}\frac{\partial J}{\partial \tilde {\bm F}} + \frac{\partial \tilde{\bm T}}{\partial {\tilde{\bm {B}}}}\frac{\partial {\tilde{\bm {B}}}}{\partial \tilde {\bm F}},
\end{align}
where $J = \det\tilde{\bm{F}}$ and $\tilde{\bm{B}} = \tilde{\bm{F}}\tilde{\bm{F}}^T$.

The corresponding intermediate terms are then:
\begin{align}
\frac{\partial J}{\partial {\tilde{F}}_{kl}} &= {J}{\tilde{F}}^{-1}_{lk}, \\
\frac{\partial \tilde{B}_{ij}}{\partial {\tilde{F}}_{kl}} &= \delta_{ik}\delta_{ml}{\tilde{F}}_{jm} + {\tilde{F}}_{im}\delta_{jk}\delta_{ml} \\
 &=  \delta_{ik}{\tilde{F}}_{jl} + {\tilde{F}}_{il}\delta_{jk}.
\end{align}
The relationship for the updated Cauchy stress is repeated here:
\begin{equation}
\begin{aligned}
T_{ij} = &\ 2C_1J^{-5/3}\left[\tilde{B}_{ij} - \frac{1}{3}I_1\delta_{ij}\right] + \\ 
&\ 2C_2J^{-7/3}\left[I_1\tilde{B}_{ij} - \tilde{B}_{im}\tilde{B}_{mj} - \frac{2}{3}I_2\delta_{ij}\right] + \\
&\ 2D_1(J-1)\delta_{ij}.
\end{aligned}
\end{equation}
Then,
\begin{equation}
\begin{aligned}
\frac{\partial \tilde{T}_{ij}}{\partial J} = &\frac{-10}{3}C_1J^{-8/3}\left[\tilde{B}_{ij} - \frac{1}{3}I_1\delta_{ij}\right] + \\
&\ \frac{-14}{3}C_2J^{-10/3}\left[I_1\tilde{B}_{ij} - \tilde{B}_{im}\tilde{B}_{mj} - \frac{2}{3}I_2\delta_{ij}\right] + \\ &\ 2D_1\delta_{ij}.
\end{aligned}
\end{equation}

To calculate the derivative $\partial \tilde{\bm T}/\partial {\tilde{\bm {B}}}$, the following relationships are needed:
\begin{align}
\frac{\partial I_1}{\partial \tilde{B}_{kl}} &= \delta_{lk},  \\
\frac{\partial I_2}{\partial \tilde{B}_{kl}} &= I_1\delta_{kl} - \tilde{B}_{lk}.
\end{align}
Finally,
\begin{equation}
\begin{aligned}
\frac{\partial \tilde{T}_{ij}}{\partial \tilde{B}_{kl}} = &\ 2C_1J^{-5/3}\left[\frac{1}{2}\left(\delta_{ik}\delta_{jl} + \delta_{il}\delta_{jk}\right) - \frac{1}{3}\delta_{ij}\delta_{kl}\right] + \\
&\ 2C_2J^{-7/3}\left[\delta_{kl}\tilde{B}_{ij} + \frac{1}{2}I_1\left(\delta_{ik}\delta_{jl} + \delta_{il}\delta_{jk}\right) -\frac{1}{2}\left(\delta_{ik}\delta_{ml} + \delta_{ik}\delta_{ml}\right)\tilde{B}_{mj} \right. + \\
&\phantom{xxxxxxxx}-\frac{1}{2}\tilde{B}_{im}\left(\delta_{mk}\delta_{jl} +\delta_{ml}\delta_{jk}\right) 
\left.- \frac{2}{3}I_1\delta_{ij}\delta_{kl} + \frac{2}{3}\delta_{ij}\tilde{B}_{lk}\right].
\end{aligned}
\end{equation}
And simplifying,
\begin{equation}
\begin{aligned}
\frac{\partial \tilde{T}_{ij}}{\partial \tilde{B}_{kl}} = &\ 2C_1J^{-5/3}\left[\frac{1}{2}\delta_{ik}\delta_{jl} + \frac{1}{2}\delta_{il}\delta_{jk} - \frac{1}{3}\delta_{ij}\delta_{kl}\right] + \\
&\ 2C_2J^{-7/3}\left[\delta_{kl}\tilde{B}_{ij} + \frac{1}{2}I_1\delta_{ik}\delta_{jl} + \frac{1}{2}I_1\delta_{il}\delta_{jk} -\frac{1}{2}\delta_{ik}\tilde{B}_{lj} -\frac{1}{2}\delta_{il}\tilde{B}_{kj} \right. + \\
&\left.\phantom{xxxxxxxx}-\frac{1}{2}\tilde{B}_{ik}\delta_{jl} -\frac{1}{2}\tilde{B}_{il}\delta_{jk} - \frac{2}{3}I_1\delta_{ij}\delta_{kl} + \frac{2}{3}\delta_{ij}\tilde{B}_{lk}\right].
\end{aligned}
\end{equation}
Thus, all terms have been defined in the calculation of the tangent modulus $\partial{\tilde{\bm{T}}}/\partial{\bm{D}}$. Like the stress and state variables, the tangent modulus is forward-rotated elsewhere in the finite element code prior to contributing to the linearized global residual equations, in the same manner described previously.

The procedure for implementing a hyperelastic material into an FEM code that only accepts hypoelastic materials has thus been established. It will be used again in \chapref{5} for implementing the mechanical behavior of cardiac tissue.

\subsubsection{Incompressibility}

Special measures must be taken to avoid \textit{volumetric locking} for materials with an incompressibility constraint. Volumetric locking occurs when there is a large mismatch between the material's apparent stiffness in deviatoric deformation compared to its volumetric deformation~\cite{rashid_2017}. The most common approach to \textit{fully} enforcing incompressibility is a \textit{mixed pressure-displacement} formulation, in which the pressure is treated as an independent variable and interpolated independently from displacement. For displacement-only formulations, however, the constraint may be enforced in a \textit{nearly incompressible} sense.

Enforcement of near-incompressibility on an integration-point level results in the displacement solution being too small, though. That is, the mesh is artificially too ``stiff.'' This volumetric locking phenomenon occurs because modes of deformation (referred to as \textit{hourglass modes} for quad or hex elements) are prevented even though they preserve the volume over the entire element.

Thus, the constraint is relaxed by enforcing incompressibility only on an element level. This amounts to modifying the incremental deformation gradient $\hat{\bm{F}}$ at each of the integration points of an element such that the dilatation is replaced by an element-averaged value, while the deviatoric deformation is unmodified. Thus, at each of the integration points, $\hat{\bm{F}}$ is replaced by $\doublehat{\bm{F}}$ in the following manner:
\begin{align}
\doublehat{\bm{F}}  &= \left(\frac{\det\bm{G}}{\hat{J}}\right)^{1/3}\hat{\bm{F}}, \\
\bm{G} &= \frac{1}{|\overline{\Omega}|} \int_{\overline{\Omega}} \hat{\bm{F}}dv,
\end{align}
where $\hat{J} = \det\hat{\bm{F}}$, $\overline{\Omega}$ is the element at its beginning-step configuration, and ${|\overline{\Omega}|}$ is its volume.

It should be noted that $\det\doublehat{\bm{F}}$ only approximates the overall volume change of the corresponding element. Nonetheless, the approach has been shown to approximate the exact solution under mesh refinement with sufficient accuracy for hex-8 and quad-4 elements. Refer to Rashid~\cite{rashid_2017} and Doll \textit{et al.}~\cite{doll_2000} for a more comprehensive description of volumetric locking for incompressible materials and how to address it, as well as a more detailed commentary on the F-bar method.

\subsection{Boundary Conditions}
The mechanical boundary conditions (BCs) considered here either prescribe displacements or tractions on the boundary of the body. Displacement boundary conditions on $\partial_u\kappa_0$ are enforced on the corresponding nodal displacements belonging to that surface. In the event that the prescribed displacements do not depend on the solution, the corresponding nodal values are no longer considered unknowns. Indeed, the nodes $a$ in the residual equations refer only to those nodes in $\kappa_0$ not belonging to $\partial_u\kappa_0$.

Traction boundary conditions prescribe the Piola traction $\overline{\bm{p}}$ in the residual equations over the patch of facets comprising $\partial_t\kappa_0$. The Piola traction may be directly specified, or the Piola pressure, Cauchy traction, or Cauchy pressure may be enforced. For the latter three options, the boundary condition must be converted to a Piola traction to fit into the form of the total Lagrangian residual equations. Enforcing the latter three BCs in a finite deformation setting is nontrivial. Specifically, facet contributions to the residual and stiffness terms require the area stretch $\alpha$ and current configuration normal $\bm{n}$ to be computed, along with their derivatives with respect to incremental nodal displacements.

Cauchy and Piola \textit{follower loads} may also be considered, in which case the normal and shear tractions ``follow'' the local orientation of the facet in the current configuration. Those BCs are less common and will not be discussed here, however. The remaining discussion revolves around the implementation of Piola tractions, Piola pressures, Cauchy tractions, and Cauchy pressures into a nonlinear finite element code. The task involves computing $\overline{\bm{p}}$ for the residual and ${\partial \overline{\bm{p}}}/{\partial {\hat {\bm{u}}}}$ for the tangent stiffness.

Calculations for the traction boundary conditions all stem from the formation of ${\bm {da}} = \alpha{\bm n}$ in the current configuration for the facet of interest. The quantity $\alpha{\bm n}$ is found via the cross product of orthonormal in-plane deformed material line directions in the current configuration: ${\alpha}{\bm n} = {\bm F}{\bm M}_1 \times {\bm F}{\bm M}_2$. For each integration point of a particular facet element, the four boundary conditions mentioned are then enforced based on the following calculations:

If Cauchy pressure $\overline{p}_c$ is prescribed, then $\bm {\overline{p}} = {-\overline{p}_c}\alpha{\bm n}$ and $\frac{\partial \overline{\bm{p}}}{\partial \hat {\bm{u}}} = {-\overline{p}_c}\frac{\partial (\alpha {\bm n})}{\partial {\hat {\bm{u}}}}$, where:
\begin{align}
\alpha{\bm n} &= {\bm F}{\bm M}_1 \times {\bm F}{\bm M}_2, \\
\frac{\partial (\alpha{\bm n})}{\partial {\hat {\bm{u}}}} &= (\frac{\partial {\bm F}}{\partial {\hat {\bm{u}}}}{\bm M}_1 \times {\bm F}{\bm M}_2) + ({\bm F}{\bm M}_1 \times \frac{\partial {\bm F}}{\partial {\hat {\bm{u}}}}{\bm M}_2).
\end{align}
If Cauchy traction $\overline{\bm{t}}$ is prescribed, then $\overline{\bm{p}} = \alpha{\overline{\bm{t}}}$ and $\frac{\partial \overline{\bm{p}}}{\partial {\hat {\bm{u}}}} = \frac{\partial \alpha}{\partial {\hat {\bm{u}}}}{\overline{\bm{t}}}$, where:
\begin{align}
{\alpha \bm n}, \ \frac{\partial (\alpha {\bm n})}{\partial {\hat {\bm{u}}}} &\text{ computed as before}, \nonumber \\
\alpha &= [\alpha {\bm n} \bm{\cdot} \alpha {\bm n}]^{1/2}, \\
 \frac{\partial{\alpha}}{\partial {\hat {\bm{u}}}} &= \frac{1}{\alpha}\frac{\partial({\alpha {\bm n}})}{\partial {\hat {\bm{u}}}} \bm{\cdot} ({\alpha \bm n}).
\end{align}
If Piola pressure $\overline{p}_p$ is prescribed, then $\overline{\bm{p}} = {-\overline{p}_p}{\bm n}$ and $\frac{\partial \overline{\bm{p}}}{\partial {\hat {\bm{u}}}} = {-\overline{p}_p}\frac{\partial {\bm n}}{\partial {\hat {\bm{u}}}}$, where:
\begin{align}
{\alpha \bm n}, \ &\frac{\partial (\alpha {\bm n})}{\partial {\hat {\bm{u}}}}, \ \alpha, \ \frac{\partial \alpha}{\partial {\hat {\bm{u}}}} \text{ computed as before}, \nonumber \\
{\bm n} &= \frac{1}{\alpha}(\alpha {\bm n}), \\
\frac{\partial {\bm n}}{\partial {\hat {\bm{u}}}} &= -\frac{1}{\alpha^2}(\alpha {\bm n}) + \frac{1}{\alpha}\frac{\partial (\alpha{\bm n})}{\partial {\hat {\bm{u}}}}.
\end{align}

Finally, If Piola traction $\overline{\bm{p}}$ is prescribed: $\overline{\bm{p}}$ is explicitly defined and $\frac{\partial \overline{\bm{p}}}{\partial {\hat {\bm{u}}}} = {\bm 0}$.

In order to perform these steps, the deformation gradient $\bm{F}$, its derivative ${\partial \bm{F}}/{\partial \hat{\bm{u}}}$, and the local material line directions $\bm{M}_1$ and $\bm{M}_2$ in the reference configuration must be computed for each integration point of each facet element. The following intermediate quantities are required to do so: 1) shape function values $N_a$ (which are simply evaluated at the integration points), 2) the ratio $J_f$ of differential areas between reference configuration and parent space, 3) the reference configuration normal ${\bm {N}}$, and 4) the in-plane shape function gradients ${\bm {g}}_a$. The remaining discussion is centered around computing those values.

To determine these quantities, assume a parametrization $\bm{X} \in \Omega^m$ for a particular facet element $m$ is available in the reference configuration in the physical space. For conventional finite element methods, the parameterization is provided by shape functions defined in the parent space: ${X}_{i} = \sum\limits_{a}{X}_{ia}{N}_a(\xi_i)$, where parameterization variables $\xi_i$ are the parent space coordinates. The cross product of ${\partial{\bm {X}}}/{\partial \xi_1}$ and ${\partial{\bm {X}}}/{\partial \xi_2}$ defines a vector that points normal to the facet in the reference configuration, with magnitude equal to the differential area spanned by ${\partial{\bm {X}}}/{\partial \xi_1}$ and ${\partial{\bm {X}}}/{\partial \xi_2}$. This magnitude and direction are indeed the quantities $J_f$ and ${\bm {N}}$ we desire, respectively.

With $\bm{N}$ defined, the local orthonormal in-plane directions in the reference configuration $\bm{M}_1$ and $\bm{M}_2$ straightforwardly follow. Calculation of the material line segment ${\bm {M}}_1$ is performed by choosing the basis vector ${\bm {e}}_p$ that is closest to lying in the plane defined by ${\bm N}$, projecting that basis vector onto the plane defined by $\bm{N}$, and scaling it to be unit magnitude. The second direction ${\bm M}_2$ is then calculated simply via ${\bm {N}} \times {\bm {M}}_1$.

In-plane shape function gradients $\bm{g}_a$ remain to be defined, which are used to reconstruct the deformation gradient $\bm{F}$ and its derivatives within the facet integral subroutine. We seek to calculate the in-plane shape function gradients in the reference configuration $\bm{g}_a = \frac{\partial N_a}{\partial \bm{X}}$ in terms of $\bm{M}_1$ and $\bm{M}_2$. We may then define ${\bm {g}}_a = {h_{1a}}{\bm {M}}_1 + {h_{2a}}{\bm {M}}_2$, where the coefficients $h_{1a}$ and $h_{2a}$ must still be determined.

If we define ${\bm {M}}$ as the 3$\times$2 matrix whose columns are ${\bm {M}}_1$ and ${\bm M}_2$, and $\bm{h}_a$ as the 2$\times$1 column vector with components $h_{1a}$ and $h_{2a}$, we may write ${\bm g}_a = {\bm M}{\bm h}_a$. The shape function gradients with respect to the parameterization variables are then \mbox{$\frac{\partial N_a}{\bm{\partial {\xi}}} = {\bm g}_a \bm{\cdot} \frac{\partial {\bm X}}{\bm{\partial {\xi}}}$}. Using the definition for ${\bm g}_a$, this can be written as:
\begin{align}
\frac{\partial N_a}{\partial {\bm \xi}} &= {\bm g}_a \bm{\cdot} \frac{\partial {\bm X}}{\partial {\bm \xi}} \\
&= {\bm M}{\bm h}_a \bm{\cdot} \frac{\partial {\bm X}}{\partial {\bm \xi}} \\
&= (\frac{\partial {\bm X}}{\partial {\bm \xi}}^T{\bm M}){\bm h}_a \\
&= {\bm H}{\bm h}_a.
\end{align}
The matrix ${\bm H} = \frac{\partial {\bm X}}{\partial {\bm \xi}}^T{\bm M}$ maps in-plane shape function gradients $h_{ia}$ acting in directions ${\bm M}_i$ into shape function gradients in directions of the parameterized variables ${\xi_j}$. The components $h_{ia}$ are then found from ${\bm h}_a = {\bm H}^{-1}\frac{\partial N_a}{\partial {\bm \xi}}$. Finally, ${\bm g}_a$ is formed using the relation ${\bm g}_a = {h_{1a}}{\bm M}_1 + {h_{2a}}{\bm M}_2$.

The previous discussion simplifies to a concise set of calculations that are performed at each integration point of a facet:
\begin{align}
\frac{\partial X_{i}}{\partial \xi_j} &= \sum_a X_{i}\frac{\partial N_a}{\partial \xi_j}, \text{\ \ \ \ }i=1,3, \text{\ \ }j = 1,2, \\
{\bm{dA}} &= \frac{\partial{\bm{X}}}{\partial \xi_1} \times \frac{\partial {\bm {X}}}{\partial \xi_2}, \\
J_f &= | {\bm {dA}}|, \\
{\bm N} &= \frac{1}{J_f}{\bm {dA}}, \\
\text{Determine } p &\text{ such that } N_p = \min_i{|N_i|}, \\
{\bm M}_1 &=\frac{ ({\bm I} - {\bm N}\otimes{\bm N}){\bm e}_p}{|({\bm I} - {\bm N}\otimes{\bm N}){\bm e}_p|}, \\
{\bm M}_2 &= {\bm N} \times {\bm M}_1, \\
H_{ij} &= \frac{\partial {\bm X}}{\partial \xi_i} \bm{\cdot} {\bm M}_j, \text{\ \ \ \ }i=1,\text{2}, \text{\ \ }j = 1,\text{2}, \\
{\bm h}_a &= {\bm H}^{-1} \frac{\partial N_a}{\partial {\bm \xi}}, \\
{\bm g}_a &= h_{1a}{\bm M}_1 + h_{2a}{\bm M}_2.
\end{align}
Finally,
\begin{align}
F_{ij} &= \delta_{ij} + \sum_a{u_{ia}g_{ja}}, \\
\frac{\partial F_{ij}}{\partial \hat{u}_{kb}} &= \delta_{ik}g_{jb}.
\end{align}

Thus, $\bm{F}$, ${\partial \bm{F}}/{\partial \hat{\bm{u}}}$, $\bm{M}_1$, and $\bm{M}_2$ have all been defined and can be used to compute the various boundary conditions described previously.

\subsection{Additional Topics}
FEM is a rich field with many more pertinent topics related to producing accurate and efficient approximations to physical phenomena. Additional important topics, to name only a few, include: more advanced nonlinear solution schemes to the residual equations; direct and iterative solvers for large matrix computations; mesh refinement/convergence studies and \textit{a posteriori} error estimation; 
enforcement of \textit{fully} incompressible materials, for example with a mixed pressure-displacement formulation; numerical modeling of frictionless and frictional contact; numerical modeling of material separation, including fracture; numerical modeling of thin structures and additional approaches to mitigating element locking; implicit and explicit approaches to modeling the dynamics of solid bodies; and coupling of multiple physical phenomena. Refer to Hughes~\cite{hughes_2000} as a starting point for addressing some of these topics.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section[A Polyhedral Finite Element Method in Computational Solid \\ Mechanics]{\texorpdfstring{A Polyhedral Finite Element Method in \\ Computational Solid Mechanics}{A Polyhedral Finite Element Method in Computational Solid \\ Mechanics}}
\label{A Polyhedral Finite Element Method in Computational Solid Mechanics}

As discussed in this chapter, conventional finite element methods utilize analytic shape functions that are defined in a parent space, from which a mapping is defined to compute element-level integration via numerical quadrature rules. This mapping introduces restrictions on the element geometry and topology that, for practical purposes, limit the element type to a very small set of choices. For complex geometries seen in biological tissues, the restrictions on element geometry and topology cause serious challenges for the automatic meshing algorithms discussed in \chapref{3}. \textit{Polyhedral finite element methods} attempt to improve upon conventional techniques by defining shape functions and corresponding integration rules for general  \textit{polyhedral} element topologies. Polyhedral FEM exhibits elements that do not need to conform to the topology of a fixed parent element, thus removing debilitating constraints on automatic meshing tools for the purposes of simulation. At the same time, these methods enjoy much of the same desirable properties of conventional FEM, including high quadrature efficiency and straightforward FEM-like boundary condition enforcement.

The construction of polygonal and polyhedral finite element shape functions, including for concave geometries, are discussed in detail by Sukumar \textit{et al.}~\cite{sukumar_2006} and Manzini \textit{et al.}~\cite{manzini_2014}. Rashid \textit{et al.}~\cite{rashid_2012, rashid_2015} offer a particular flavor of polyhedral FEM methods known as the \textit{Partitioned Element Method} (PEM), whose implementation offers a robust workflow for CAD-based simulation. An important feature of PEM stems from the realization that the shape functions do not need to be defined over the entire element domain. Instead, only their values and gradients need be defined at the quadrature points of the element.

The Partitioned Element Method explicitly partitions each element into polyhedral \textit{cells}. They are constructed in a tolerance-aware sense that is robust in the presence of geometric pathologies. These subdomains are used to define a discontinuous piecewise linear shape function in the physical space over each element, along with its corresponding quadrature rule. Shape functions are constructed first on element edges, then on element faces, and finally over the three-dimensional element. The shape function construction on lower-order topes informs the construction on higher-order topes. In each case, a quadratic objective function is minimized in an attempt to minimize jumps in the shape function and its gradients along cell interfaces. The solution of this minimization problem leads to a small linear system to be solved for each element in a mesh at the beginning of the simulation. Quadrature rules are defined based on specifying the integration points at the cell centroids and the integration weights as the cell volumes. Additional constraints to the minimization problem ensure \textit{quadrature consistency} (the property that a constant stress field exactly satisfies the weak form of equilibrium on a single element). PEM has been shown to converge at the same rate as FEM~\cite{rashid_2012}. Many of the considerations outlined are nontrivial - refer to the resources cited for a more rigorous and complete accounting of the method.

As it pertains to the user of simulation software for performing biomechanical simulations, PEM offers three critical benefits related to meshing. First, the meshing procedure need not adhere to the strict geometric and topological requirements of conventional FEM, allowing for more robust automated mesh generation. Second, as discussed in \chapref{3}, the simulation and geometric resolutions are decoupled. Namely, the simulation resolution need only be refined to the extent that accurate solutions can be provided, rather than being constrained in some way by the number of points and polygons used to the describe the surface of the object. And lastly, linear PEM elements have been shown to produce accurate results, which together with the previous benefit can significantly reduce the number of DOF compared to automated higher-order FEM approaches. This reduction in DOF was demonstrated in \figref{compdof}. A further exploration of the polyhedral approach and its benefits and will be conducted alongside conventional FEM in modeling cardiac mechanics in \chapref{5}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%